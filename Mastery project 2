--1. What is the most common room type in NYC Airbnb listings?
SELECT room_type, COUNT(*) AS count
FROM room_types
GROUP BY room_type
ORDER BY count DESC;

--2. What is the average price of the listings by room type "shared room"?This question is required.
SELECT ROUND(AVG(price),2)
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
WHERE room_type = 'shared room';

--3. Which borough has the highest average price per month?
SELECT borough, AVG(price_per_month) AS avg_price
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
GROUP BY borough
ORDER BY avg_price DESC;

--4. How many listings of each room type are in each borough?
SELECT borough, room_type, COUNT(calculated_host_listings_count) AS listing_count
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
JOIN reviews AS rv
ON p.listing_id = rv.listing_id
GROUP BY borough, room_type;

--5. How many listings in each room type category have a price greater than $500 per night?
SELECT room_type, COUNT(calculated_host_listings_count) AS listing_count
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
JOIN reviews AS rv
ON p.listing_id = rv.listing_id
WHERE price > 500
GROUP BY room_type;

--6. What is the distribution of listing prices by borough?
SELECT borough, MIN(price), MAX(price), AVG(price)
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
GROUP BY borough;

--7. What is the estimated amount of revenue generated by hosts in each borough?
SELECT borough, SUM(price*booked_days_365)
FROM prices AS p
JOIN reviews AS r
ON p.listing_id = r.listing_id
GROUP BY borough;

--8. What is the average price per month for listings in each neighborhood?
SELECT neighbourhood, room_type, AVG(price_per_month) AS avg_price_per_month
FROM prices AS p
JOIN room_types AS r
ON p.listing_id = r.listing_id
GROUP BY neighbourhood, room_type
ORDER BY avg_price_per_month DESC;

--9. How many listings have no reviews?
SELECT *
FROM reviews 
WHERE last_review IS NULL;

--10. How do the estimated book days correlate with the price of an Airbnb listing in New York City?
SELECT CORR(booked_days_365, price)
FROM reviews AS r
JOIN prices AS p
ON r.listing_id= p.listing_id;